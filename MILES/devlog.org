#+TITLE: MILES development log
#+AUTHOR: D. HU
#+TODO: TODO(t) WAIT(w) | DONE(d)
#+TODO: | CNCL(c@/!)
#+TODO: REPORT(r!) BUG(b!) KNOWNCAUSE(k!) | FIXED(f!)
#+STARTUP: logdone

Version: v0 (202006??)
* TODO tests [4/5]
** KNOWNCAUSE fitM83
- Note taken on [2020-06-18 Thu 16:50] \\
  Pb: 1. very slow; 2. can block at a certain pixel; 3. discontinuity at 20 microns; 4. ALL(mask(x,y,:)) or ANY(mask(x,y,:)) ? 5. diagonal covar matrix used (for now); 6. calib error not yet added
- State "KNOWNCAUSE" from "TODO"       [2020-06-18 Thu 16:50]
** DONE total [3/3]
*** DONE synthetic 
CLOSED: [2020-06-03 Wed 23:11]
*** DONE specModel
CLOSED: [2020-05-25 Mon 18:17]
*** DONE degradeRes
CLOSED: [2020-05-28 Thu 12:55]
** FIXED profiles
CLOSED: [2020-04-25 Sat 19:27]
- Note taken on [2020-05-20 Wed 23:39] \\
  Corrected the integration in normalization tests. X grid should not be too wide or the the integration of undersampled profiles will not be 1
- State "FIXED"      from "DONE"       [2020-05-20 Wed 23:39]
** CNCL modifBB
CLOSED: [2020-06-10 Wed 12:06]
- State "CNCL"       from "KNOWNCAUSE" [2020-06-10 Wed 12:06] \\
  Transfer to complete fit test of M83 (~test_fitM83~)
- Note taken on [2020-05-11 Mon 14:32] \\
  Test chi2min with observation (M83), 3D FITS data imported via Python UI (fits2h5)
- State "KNOWNCAUSE" from "DONE"       [2020-05-11 Mon 14:32]
** DONE compile
CLOSED: [2020-04-24 Fri 15:00]
* TODO miles [81%]
:PROPERTIES:
:COOKIE_DATA: recursive
:END:
** DONE datable [3/3]
*** TYPE, PUBLIC
**** DONE ~instr_res~
CLOSED: [2020-05-11 Mon 13:31]
- res
**** DONE ~lines_IN~
CLOSED: [2020-05-11 Mon 13:57]
- LIN
**** DONE ~bands_IN~
CLOSED: [2020-05-11 Mon 13:57]
- BIN
** DONE auxil (MODULE) [100%]
*** TYPE, PUBLIC
**** DONE ~par_str~
CLOSED: [2020-05-11 Mon 10:52]
- par
**** DONE ~parinfo_str~
CLOSED: [2020-06-09 Tue 18:51]
**** DONE ~Qabs_str~
CLOSED: [2020-05-11 Mon 11:47]
- ~make_Qabs~ / nQabs
- ~modifBB~ / Qabs
*** SUBROUTINE
**** FIXED ~make_par~ : Create the parameter structure
CLOSED: [2020-06-09 Tue 09:53]
- State "FIXED"      from "KNOWNCAUSE" [2020-06-10 Wed 09:53]
- Note taken on [2020-06-09 Tue 09:52] \\
  Add Npar and parinfo as output option; par turns to be optional
- State "KNOWNCAUSE" from "DONE"       [2020-06-09 Tue 09:51]
**** DONE ~make_Qabs~ : Read optical properties
CLOSED: [2020-05-11 Mon 11:47]
**** CNCL ~chi2_INIT~ : Initialization of parameters for chi2 method
CLOSED: [2020-05-25 Mon 18:11]
- State "CNCL"       from "DONE"       [2020-06-02 Tue 10:23] \\
  Removed. Parameters stored in a separate module/file.
*** FUNCTION
**** DONE ~degradeRes~ : Automatize the degradation of the spectral resolution
CLOSED: [2020-05-11 Mon 13:40]
**** Analytical functions of the individual features
***** DONE ~modifBB~ : Dust contimuum (N BB)
CLOSED: [2020-05-11 Mon 13:16]
***** FIXED ~gaussLine~ : Atomic & molecular unresolved lines (Gauss profile)
CLOSED: [2020-05-20 Wed 23:36]
- State "FIXED"      from "KNOWNCAUSE" [2020-05-20 Wed 23:36]
- Note taken on [2020-05-12 Tue 10:51] \\
  ~gaussLine_w~ was added to make wave-in-nu-out possible (which is the idea here), while it rose a confusion when doing normalization test. 
  Finally, the merger of this option lead to a LOGICAL "w2nu", .TRUE. when input is wavelength, because the profiles will be used to fit the obs curves in function of nu whose intensities Fnu are in W/m2/Hz (Jy). 
  Idem. for lorentzBand & extCurve
- State "KNOWNCAUSE" from "DONE"       [2020-05-12 Tue 10:51]
***** FIXED ~lorentzBand~ : Resolved aromatic bands (Asymmetric Lorentz profile)
CLOSED: [2020-05-20 Wed 23:36]
- State "FIXED"      from "KNOWNCAUSE" [2020-05-20 Wed 23:36]
- State "KNOWNCAUSE" from "DONE"       [2020-05-12 Tue 10:57]
***** FIXED ~extCurve~
CLOSED: [2020-05-20 Wed 23:36]
- State "FIXED"      from "KNOWNCAUSE" [2020-05-20 Wed 23:36]
- State "KNOWNCAUSE" from "TODO"       [2020-05-12 Tue 10:57]
**** FIXED ~specModel~ : Total model function for chi2 calling
CLOSED: [2020-06-17 Wed 01:56]
- State "FIXED"      from "REPORT"     [2020-06-17 Wed 01:56]
- Note taken on [2020-06-16 Tue 19:36] \\
  [via Fred]
  1. Do not read extcurve file everytime -> call it only once at the beginning
  2. Do not do interpolation in func modifBB -> interpolate Qabs once and for all (add optional input "waveall" in ~make_Qabs~ 
- State "REPORT"     from "FIXED"      [2020-06-17 Wed 01:52]
- State "FIXED"      from "KNOWNCAUSE" [2020-06-16 Tue 15:22]
- Note taken on [2020-06-13 Sat 23:12] \\
  Create interface for 3D, 2D & scalar (gen) models
- State "KNOWNCAUSE" from "FIXED"      [2020-06-13 Sat 23:12]
- State "FIXED"      from "KNOWNCAUSE" [2020-06-09 Tue 10:26]
- Note taken on [2020-06-09 Tue 10:25] \\
  Add Npar and parinfo as output option
- State "KNOWNCAUSE" from "FIXED"      [2020-06-09 Tue 10:25]
- State "FIXED"      from "BUG"        [2020-06-03 Wed 17:20]
- Note taken on [2020-06-03 Wed 17:19] \\
  optional output should not be allocated out of IF (PRESENT) loop
- State "BUG"        from "FIXED"      [2020-06-03 Wed 17:19]
- State "FIXED"      from "KNOWNCAUSE" [2020-05-29 Fri 15:15]
- Note taken on [2020-05-26 Tue 16:41] \\
  Replace massStar by Fstar (total surface brightness or luminosity of star), with BB normalized by Stefan-Boltzmann constant.
- State "KNOWNCAUSE" from "DONE"       [2020-05-26 Tue 16:41]
** DONE Init [100%]
*** DONE input spectrum (fits2h5.py)
CLOSED: [2020-05-11 Mon 15:21]
*** DONE modeled spectrum
CLOSED: [2020-06-09 Tue 18:51]
** TODO Chi2 [66%]
*** DONE test chi2min with synthetic spectrum
CLOSED: [2020-06-04 Thu 11:27]
*** DONE test chi2min with M83 (input 3D data)
CLOSED: [2020-06-18 Thu 16:50]
*** TODO Python UI for the inputs
** TODO Bayesian [0%]
*** TODO build structure according to ~fitSED_HB~ code
** WAIT Hierarchical Bayesian [%]
* TODO UI (Python) [75%]
:PROPERTIES:
:COOKIE_DATA: recursive
:END:
** TODO ~make_HB~
** TODO ~make_chi2~
** DONE show results [3/3]
*** DONE ~test_fitM83~ (chi2)
CLOSED: [2020-06-19 Fri 00:24]
*** DONE ~test_total~
CLOSED: [2020-06-19 Fri 00:21]
*** DONE ~test_profiles~
CLOSED: [2020-06-19 Fri 00:21]
** DONE fits2h5
CLOSED: [2020-04-28 Tue 00:07]
** DONE asc2h5
CLOSED: [2020-04-27 Mon 23:35]
