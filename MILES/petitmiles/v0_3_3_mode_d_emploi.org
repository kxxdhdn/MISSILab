#+TITLE: Test MILES
#+AUTHOR: D. HU

* Copy ~/petitmiles~ to your testing place
* Modify paths in following files
** ~make_miles.mk~
- MKSW
- MILIBDIR
* Always execute Fortran programs under this path: ~/your_testing_place/petitmiles/programs~
* Generate simulated spectra
#+BEGIN_SRC bash
pip install astylo # optional
python /your_testing_place/petitmiles/pynout/input_genpar.py
cd /your_testing_place/petitmiles/programs
make
./genpar
python /your_testing_place/petitmiles/pynout/show_genpar.py # optional
./simulate_MIR
## Line 40-42 & 65 may can be modified according to simulate_MIR.90
python /your_testing_place/petitmiles/pynout/show_galspec.py # optional
#+END_SRC
* Fitting
#+BEGIN_SRC bash
python /your_testing_place/petitmiles/pynout/input_fitpar_chi2.py
./fitpar_chi2
## (Alternative) analysis.f90 line 59 (chi2ana = .TRUE.)
./analysis
## Open show_fitpar.py and comment line 23 (mod = 'HB')
## The x & y ranges in line 24 & 25 should be coherent with simulate_MIR.f90
python /your_testing_place/petitmiles/pynout/show_fitpar.py # optional
## Open show_corr.py and comment line 23 (mod = 'HB')
python /your_testing_place/petitmiles/pynout/show_corr.py # optional

## Open input_fitpar_HB.py and modify line 65 (Nmcmc)
python /your_testing_place/petitmiles/pynout/input_fitpar_HB.py
./fitpar_HB
## (Alternative) analysis.f90 line 60 (HBana = .TRUE.)
./analysis
## Open show_fitpar.py and uncomment line 23 (mod = 'HB')
python /your_testing_place/petitmiles/pynout/show_fitpar.py # optional
## Open show_corr.py and uncomment line 23 (mod = 'HB')
python /your_testing_place/petitmiles/pynout/show_corr.py # optional

## Plots can be found in /your_testing_place/petitmiles/out1/Figures/
#+END_SRC
* How to modify ~simulate_MIR~
** Line 80 & 81
- Np: sample size for each configuration
- Nq: number of configurations (varying S/N and continuum)
** Line 147-155
- \mu and \sigma of 4 independent band ratios (fixing I11.3)
** Line 174-179
- corr(Ncorr): correlation coefficients for different band ratios (R)
** Line 243
- multiCONT(Nq): factor of multiplication for continua
** Line 279
- SovN(Nq): parameter defining S/N
